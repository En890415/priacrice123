<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>業者/販賣機</title>
</head>
<body>
    <div id="wrapper;" style="display: -webkit-flex;
                                   display:flex;
                                   -webkit-align-items: center;
                                           align-items: center;
                                   -webkit-justify-content: center;
                                           justify-content: center;">
           <!----------->
           <div w3-include-html="SideBar_test.html" style="display:inline-block; vertical-align: top;"></div>
       <script src="https://www.w3schools.com/lib/w3.js"></script>
        <script>
            w3.includeHTML();
        </script>
        
    <div style="display:inline-block; vertical-align: top; width:90%" >
        
            搜尋：<input type="search" class="light-table-filter" data-table="order-table" placeholder="請輸入關鍵字">
        
    <table class="order-table"  border="10" width="100%" height="400"
     cellpadding="5" style="border-collapse:collapse;">
    <thead >
        
            <th>販賣機編號</th>
            <th>縣市</th>
            <th>狀態</th>    
    </thead>
    </table>
</div>
    </div>        
</body>
</html>
<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.5/firebase-firestore.js"></script>
 <script>
      const firebaseConfig = {
    apiKey: "AIzaSyCnI0sknT-WrZwcvZHKGpPiioz66vp6Okk",
    authDomain: "sa-no3.firebaseapp.com",
    databaseURL: "https://sa-no3.firebaseio.com",
    projectId: "sa-no3",
    storageBucket: "sa-no3.appspot.com",
    messagingSenderId: "1015427284395",
    appId: "1:1015427284395:web:008dc524a161da95bfe6ee",
    measurementId: "G-MDP1SN9YWK"
  };
  firebase.initializeApp(firebaseConfig);
      var db = firebase.firestore();
     var ref = db.collection("VM");
        ref.onSnapshot(querySnapshot =>{
            querySnapshot.forEach(doc =>{
                renderAccount(doc);
                
                })
    })
const TtableList = document.querySelector('#ttable') ;
            function renderAccount(doc){
                let tr = document.createElement('tr');
                tr.style.textAlign="center";
                let td_Id = document.createElement('td');
                let td_Adress = document.createElement('td');
                let td_Status = document.createElement('td');
                
                tr.setAttribute('data-id', doc.id);
                td_Id.textContent = doc.id;
                td_Adress.textContent = doc.data()["address"];
                td_Status.textContent = doc.data()["status"];
                td_Status.style.background = td_Status.innerHTML;
                
                tr.appendChild(td_Id);
                tr.appendChild(td_Adress);
                tr.appendChild(td_Status);
                
              
                TtableList.appendChild(tr);
            }
</script>

<script>
    (function(document) {
  'use strict';

  // 建立 LightTableFilter
  var LightTableFilter = (function(Arr) {
      console.log("建立 LightTableFilter完成");

    var _input;

    // 資料輸入事件處理函數
    function _onInputEvent(e) {
      _input = e.target;
      var tables = document.getElementsByClassName(_input.getAttribute('data-table'));
      Arr.forEach.call(tables, function(table) {
        Arr.forEach.call(table.tBodies, function(tbody) {
          Arr.forEach.call(tbody.rows, _filter);
        });
      });
    }

    // 資料篩選函數，顯示包含關鍵字的列，其餘隱藏
    function _filter(row) {
      var text = row.textContent.toLowerCase(), val = _input.value.toLowerCase();
      row.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';
      console.log("顯示關鍵字，其餘隱藏，完成");
    }

    return {
      // 初始化函數
      init: function() {
        var inputs = document.getElementsByClassName('light-table-filter');
        Arr.forEach.call(inputs, function(input) {
          input.oninput = _onInputEvent;
        });
      }
    };
  })(Array.prototype);

  // 網頁載入完成後，啟動 LightTableFilter
  document.addEventListener('readystatechange', function() {
    if (document.readyState === 'complete') {
        console.log("啟動LightTableFilter完成");
      LightTableFilter.init();
    }
  });

})(document);
    </script>
